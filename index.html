<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kingsong</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/Draggable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.2/TweenMax.min.js"></script>

    <script src="assets/js/color.js"></script>
    <script src="assets/js/transition.js"></script>

    <style>
        .image-container {
            width: 100%;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .image-box {
            display: flex;
            width: max-content;
            height: auto;
            gap: 0.5rem;
        }

        .image-box img {
            transition: width 0.3s ease, height 0.3s ease;
        }

        .image-box img:hover {
            transform: scale(1.1);
        }

        .image {
            width: 200px;
            height: 300px;
        }
    </style>
</head>

<body>
    <div class="noise"></div>
    <header id="header">
        <div class="header_inner">
            <h1 class="logo">
                developer<br />
                portfolio
            </h1>
            <nav class="nav">
                <ul>
                    <li><a href="index.html">001/Main</a></li>
                    <li><a href="page/work.html">002/Work</a></li>
                    <li><a href="page/team.html">003/Team</a></li>
                    <li><a href="/">004/Comment</a></li>
                    <li><a href="/">005/Contact</a></li>
                </ul>
            </nav>
            <button class="color">
                <img src="assets/img/svg/eyes.svg" alt="eyes">
            </button>
        </div>
    </header>
    <main id="main">
        <div id="slider" class="image-container">
            <div class="image-box">
                <img src="assets/img/QW_15.jpg" alt="" class="image">
                <img src="assets/img/QW_16.jpg" alt="" class="image">
                <img src="assets/img/QW_17.jpg" alt="" class="image">
                <img src="assets/img/송성민3.jpg" alt="" class="image">
                <img src="assets/img/QW_18.jpg" alt="" class="image">
                <img src="assets/img/QW_19.jpg" alt="" class="image">
                <img src="assets/img/QW_20.jpg" alt="" class="image">
            </div>
        </div>
        <div class="intro">
            <p>work</p>
            <p class="active">portfolio</p>
            <p>about</p>
        </div>
        <div class="intro_detail">
            <p>
                아직 부족한 부분이 많다 생각하여 국비학원에 참여했습니다.<br>
                하루 8시간씩 공부하며, 더 나은 개발자가 되기 위해 노력하고 있습니다.<br>
                또한, 개발자로서의 역량을 키우기 위해 프로젝트를 진행하고 있습니다.<br>
                이러한 경험을 통해 더 나은 개발자가 되기 위해 노력하고 있습니다.<br>
            </p>
        </div>
    </main>
    <footer id="footer">
        <div class="marquee">
            <div class="track">
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
                <span class="text -twox">ARE YOU SURE?<span class="-green">I CAN DO IT!</span></span>
            </div>
        </div>
    </footer>
    <script>
        let iteration = 0;

        gsap.set('.image-box .image', { xPercent: 400, opacity: 0, scale: 0 });

        const spacing = 0.05,
            snapTime = gsap.utils.snap(spacing),
            cards = gsap.utils.toArray('.image-box .image'),

            aniFunc = element => {
                const tl = gsap.timeline();
                tl.fromTo(element, { scale: 0, opacity: 0 }, { scale: 1, opacity: 1, zIndex: 100, duration: 0.5, yoyo: true, repeat: 1, ease: "power1.in", immediateRender: false })
                    .fromTo(element, { xPercent: 400 }, { xPercent: -400, duration: 1, ease: "none", immediateRender: false }, 0);
                return tl;
            }

        seamlessLoop = buildSeamlessLoop(cards, spacing, aniFunc),
            playhead = { offset: 0 }, // 무한히 어느 방향으로든 갈 수 있는 플레이헤드 위치를 시뮬레이션하는 프록시 객체이며, 업데이트할 때 이를 시차 루프 타임라인의 해당 시간으로 변환함.
            wrapTime = gsap.utils.wrap(0, seamlessLoop.duration()), // 오프셋(시간)을 입력하면 해당 시차 루프의 지속 시간 사이의 안전한 시간으로 반환됨.
            scrub = gsap.to(playhead, { // 시차 루프의 플레이헤드를 부드럽게 스크럽하기 위해 이 트윈을 재사용
                offset: 0,
                onUpdate() {
                    seamlessLoop.time(wrapTime(playhead.offset)); // 오프셋을 시차 루프 타임라인의 "안전한" 해당 시간으로 변환
                },
                duration: 100,
                ease: "none",
                paused: true
            }),

            trigger = ScrollTrigger.create({
                start: 0,
                onUpdate(self) {
                    let scroll = self.scroll();
                    if (scroll > self.end - 1) {
                        wrap(1, 2);
                    } else if (scroll < 1 && self.direction < 0) {
                        wrap(-1, self.end - 2);
                    } else {
                        scrub.vars.offset = (iteration + self.progress) * seamlessLoop.duration();
                        scrub.invalidate().restart(); // 성능을 향상시키기 위해 동일한 트윈을 무효화하고 다시 시작함. 각 업데이트에서 덮어쓰거나 새로운 트윈을 만들 필요 없음.
                    }
                },
                end: "+=3000",
                pin: ".image-container",
                horizontal: true,
                pin: true
            })

        progressToScroll = progress => gsap.utils.clamp(1, trigger.end - 1, gsap.utils.wrap(0, 1, progress) * trigger.end),
            wrap = (iterationDelta, scrollTo) => {
                iteration += iterationDelta;
                trigger.scroll(scrollTo);
                trigger.update(); // 기본적으로 trigger.scroll()을 호출하면 1 틱 기다렸다가 업데이트됨.
            };

        ScrollTrigger.addEventListener("scrollEnd", () => scrollToOffset(scrub.vars.offset));

        // 오프셋을 입력하면 시차 루프의 totalTime 값에 해당하는 위치로 스크롤 플레이헤드를 이동시키고 필요하면 래핑함.
        function scrollToOffset(offset) {
            let snappedTime = snapTime(offset),
                progress = (snappedTime - seamlessLoop.duration() * iteration) / seamlessLoop.duration(),
                scroll = progressToScroll(progress);
            if (progress >= 1 || progress < 0) {
                return wrap(Math.floor(progress), scroll);
            }
            trigger.scroll(scroll);
        }

        function buildSeamlessLoop(items, spacing, aniFunc) {
            let rawSequence = gsap.timeline({ paused: true }), // 모든 "실제" 애니메이션이 있는 곳
                seamlessLoop = gsap.timeline({ // rawSequence의 플레이헤드를 스크럽하여 무한히 루프되는 것처럼 보이게 함.
                    paused: true,
                    repeat: -1, // 무한 스크롤/루프를 수용하기 위해
                    onRepeat() { // 매우 드문 엣지 케이스 버그를 해결 (GSAP 3.6.1에서 수정됨)
                        this._time === this._dur && (this._tTime += this._dur - 0.01);
                    },
                    onReverseComplete() {
                        this.totalTime(this.rawTime() + this.duration() * 100); // 뒤로 무한 루프
                    }
                }),
                cycleDuration = spacing * items.length,
                dur; // 하나의 animateFunc()의 지속 시간 (아래 .forEach()에서 채워짐)

            // 루프를 3번 반복하여 시작과 끝에 추가 사이클이 생기도록 함 - 2번째 사이클에서만 플레이헤드를 스크럽함.
            items.concat(items).concat(items).forEach((item, i) => {
                let anim = aniFunc(items[i % items.length]);
                rawSequence.add(anim, i * spacing);
                dur || (dur = anim.duration());
            });

            // 플레이헤드를 2번째 사이클의 시작부터 끝까지 선형으로 애니메이션화함 (따라서 시작과 끝에 하나의 "추가" 사이클이 생김).
            seamlessLoop.fromTo(rawSequence, {
                time: cycleDuration + dur / 2
            }, {
                time: "+=" + cycleDuration,
                duration: cycleDuration,
                ease: "none"
            });
            return seamlessLoop;
        }
    </script>

</body>

</html>